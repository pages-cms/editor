{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "editor",
  "title": "Editor",
  "description": "A format-aware HTML/Markdown editor built on TipTap.",
  "dependencies": [
    "lucide-react",
    "@tiptap/core",
    "@tiptap/extension-image",
    "@tiptap/extension-link",
    "@tiptap/extension-table",
    "@tiptap/extension-table-cell",
    "@tiptap/extension-table-header",
    "@tiptap/extension-table-row",
    "@tiptap/extension-underline",
    "@tiptap/markdown",
    "@tiptap/react",
    "@tiptap/starter-kit",
    "@tiptap/suggestion",
    "tippy.js"
  ],
  "files": [
    {
      "path": "registry/default/editor/editor.tsx",
      "content": "import { type HTMLAttributes, useEffect, useRef, useState } from \"react\";\nimport { EditorContent, useEditor } from \"@tiptap/react\";\nimport { BubbleMenu } from \"@tiptap/react/menus\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Underline from \"@tiptap/extension-underline\";\nimport Link from \"@tiptap/extension-link\";\nimport Image from \"@tiptap/extension-image\";\nimport { Table } from \"@tiptap/extension-table\";\nimport TableRow from \"@tiptap/extension-table-row\";\nimport TableHeader from \"@tiptap/extension-table-header\";\nimport TableCell from \"@tiptap/extension-table-cell\";\nimport { Markdown } from \"@tiptap/markdown\";\nimport {\n  Bold,\n  Columns3,\n  Check,\n  ChevronDownIcon,\n  Code,\n  Minus,\n  Plus,\n  RemoveFormatting,\n  Rows3,\n  Table as TableIcon,\n  Italic,\n  Link as LinkIcon,\n  Strikethrough,\n  Underline as UnderlineIcon,\n  X,\n  type LucideIcon,\n} from \"lucide-react\";\nimport SlashCommands from \"./slash-command/commands\";\n\nexport type EditorFormat = \"html\" | \"markdown\";\nexport type EditorMode = \"wysiwyg\" | \"source\";\n\ntype EditorProps = {\n  value?: string;\n  onChange?: (value: string) => void;\n  disabled?: boolean;\n  format?: EditorFormat;\n  mode?: EditorMode;\n  sourceDebounceMs?: number;\n  onSwitchToSource?: (value: string, format: EditorFormat) => string | Promise<string>;\n  onSwitchToEditor?: (value: string, format: EditorFormat) => string | Promise<string>;\n} & Omit<HTMLAttributes<HTMLDivElement>, \"onChange\">;\n\ntype ToggleAction = {\n  label: string;\n  icon: LucideIcon;\n  isActive: () => boolean;\n  run: () => void;\n  toggle: true;\n};\n\ntype PlainAction = {\n  label: string;\n  icon: LucideIcon;\n  run: () => void;\n  toggle?: false;\n};\n\ntype MenuAction = ToggleAction | PlainAction;\n\ntype IconButtonOptions = {\n  label: string;\n  icon: LucideIcon;\n  onClick: () => void;\n  disabled: boolean;\n  toggle?: boolean;\n  pressed?: boolean;\n  className?: string;\n};\n\ntype BlockType =\n  | \"paragraph\"\n  | \"heading1\"\n  | \"heading2\"\n  | \"heading3\"\n  | \"bulletList\"\n  | \"orderedList\"\n  | \"blockquote\"\n  | \"codeBlock\";\n\nconst blockOptions: Array<{ value: BlockType; label: string }> = [\n  { value: \"paragraph\", label: \"Text\" },\n  { value: \"heading1\", label: \"Heading 1\" },\n  { value: \"heading2\", label: \"Heading 2\" },\n  { value: \"heading3\", label: \"Heading 3\" },\n  { value: \"bulletList\", label: \"Bulleted list\" },\n  { value: \"orderedList\", label: \"Numbered list\" },\n  { value: \"blockquote\", label: \"Quote\" },\n  { value: \"codeBlock\", label: \"Code block\" },\n];\n\nexport function Editor({\n  value = \"\",\n  onChange = () => undefined,\n  disabled = false,\n  format = \"html\",\n  mode = \"wysiwyg\",\n  sourceDebounceMs = 500,\n  onSwitchToSource,\n  onSwitchToEditor,\n  ...props\n}: EditorProps) {\n  const [showLinkInput, setShowLinkInput] = useState(false);\n  const [showTableActions, setShowTableActions] = useState(false);\n  const [showAltInput, setShowAltInput] = useState(false);\n  const [isInTable, setIsInTable] = useState(false);\n  const [isOnImage, setIsOnImage] = useState(false);\n  const [linkUrl, setLinkUrl] = useState(\"\");\n  const [imageAltText, setImageAltText] = useState(\"\");\n  const [sourceValue, setSourceValue] = useState(value);\n  const bubbleMenuRef = useRef<HTMLDivElement>(null);\n  const prevModeRef = useRef<EditorMode>(mode);\n  const sourceDebounceRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const isSourceMode = mode === \"source\";\n\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        link: false,\n        underline: false,\n      }),\n      Underline,\n      Link.configure({\n        openOnClick: false,\n        enableClickSelection: true,\n        HTMLAttributes: {\n          rel: null,\n          target: null,\n        },\n      }),\n      Image,\n      Table,\n      TableRow,\n      TableHeader,\n      TableCell,\n      Markdown,\n      SlashCommands,\n    ],\n    content: value || (format === \"markdown\" ? \"\" : \"<p></p>\"),\n    editable: !disabled,\n    immediatelyRender: false,\n    onUpdate: ({ editor: nextEditor }) => {\n      onChange(format === \"markdown\" ? nextEditor.getMarkdown() : nextEditor.getHTML());\n    },\n  });\n\n  useEffect(() => {\n    if (!editor) return;\n    const current = format === \"markdown\" ? editor.getMarkdown() : editor.getHTML();\n    if (value !== current) {\n      editor.commands.setContent(value || (format === \"markdown\" ? \"\" : \"<p></p>\"), {\n        emitUpdate: false,\n        contentType: format,\n      });\n    }\n  }, [editor, value, format]);\n\n  useEffect(() => {\n    if (!isSourceMode) return;\n    setSourceValue(value || (format === \"markdown\" ? \"\" : \"<p></p>\"));\n  }, [isSourceMode, value, format]);\n\n  useEffect(() => {\n    if (!editor) return;\n    editor.setEditable(!disabled && !isSourceMode);\n  }, [editor, disabled, isSourceMode]);\n\n  useEffect(() => {\n    if (!editor) return;\n\n    const wasSource = prevModeRef.current === \"source\";\n    const nowSource = mode === \"source\";\n    prevModeRef.current = mode;\n\n    if (!wasSource && nowSource) {\n      const enterSourceMode = async () => {\n        const currentValue = format === \"markdown\" ? editor.getMarkdown() : editor.getHTML();\n        const sourceModeValue = onSwitchToSource\n          ? await onSwitchToSource(currentValue, format)\n          : currentValue;\n        setShowLinkInput(false);\n        setShowTableActions(false);\n        setShowAltInput(false);\n        setSourceValue(sourceModeValue);\n      };\n      void enterSourceMode();\n    }\n\n    if (wasSource && !nowSource) {\n      const exitSourceMode = async () => {\n        if (sourceDebounceRef.current) {\n          clearTimeout(sourceDebounceRef.current);\n          sourceDebounceRef.current = null;\n        }\n\n        const editorModeValue = onSwitchToEditor\n          ? await onSwitchToEditor(sourceValue, format)\n          : sourceValue;\n\n        if (editorModeValue !== sourceValue) setSourceValue(editorModeValue);\n        editor.commands.setContent(editorModeValue, { contentType: format });\n      };\n      void exitSourceMode();\n    }\n  }, [editor, mode, format, onSwitchToSource, onSwitchToEditor, sourceValue]);\n\n  useEffect(() => {\n    return () => {\n      if (sourceDebounceRef.current) clearTimeout(sourceDebounceRef.current);\n    };\n  }, []);\n\n  useEffect(() => {\n    if ((!showLinkInput && !showTableActions && !showAltInput) || !editor) return;\n\n    const onPointerDown = (event: PointerEvent) => {\n      const target = event.target as Node | null;\n      if (!target) return;\n\n      const insideBubble = bubbleMenuRef.current?.contains(target) ?? false;\n      if (!insideBubble) {\n        setShowLinkInput(false);\n        setShowTableActions(false);\n        setShowAltInput(false);\n      }\n    };\n\n    document.addEventListener(\"pointerdown\", onPointerDown, true);\n    return () => {\n      document.removeEventListener(\"pointerdown\", onPointerDown, true);\n    };\n  }, [showLinkInput, showTableActions, showAltInput, editor]);\n\n  useEffect(() => {\n    if (!editor) return;\n\n    const updateTableContext = () => {\n      const nextIsInTable =\n        editor.isActive(\"table\") ||\n        editor.isActive(\"tableRow\") ||\n        editor.isActive(\"tableHeader\") ||\n        editor.isActive(\"tableCell\");\n      const nextIsOnImage = editor.isActive(\"image\");\n\n      setIsInTable(nextIsInTable);\n      if (!nextIsInTable) setShowTableActions(false);\n      setIsOnImage(nextIsOnImage);\n      if (!nextIsOnImage) setShowAltInput(false);\n    };\n\n    updateTableContext();\n    editor.on(\"selectionUpdate\", updateTableContext);\n    editor.on(\"transaction\", updateTableContext);\n\n    return () => {\n      editor.off(\"selectionUpdate\", updateTableContext);\n      editor.off(\"transaction\", updateTableContext);\n    };\n  }, [editor]);\n\n  if (!editor) return null;\n\n  const getBlockType = (): BlockType => {\n    if (editor.isActive(\"heading\", { level: 1 })) return \"heading1\";\n    if (editor.isActive(\"heading\", { level: 2 })) return \"heading2\";\n    if (editor.isActive(\"heading\", { level: 3 })) return \"heading3\";\n    if (editor.isActive(\"bulletList\")) return \"bulletList\";\n    if (editor.isActive(\"orderedList\")) return \"orderedList\";\n    if (editor.isActive(\"blockquote\")) return \"blockquote\";\n    if (editor.isActive(\"codeBlock\")) return \"codeBlock\";\n    return \"paragraph\";\n  };\n\n  const setBlockType = (next: BlockType) => {\n    const chain = editor.chain().focus();\n\n    switch (next) {\n      case \"paragraph\":\n        chain.setParagraph().run();\n        break;\n      case \"heading1\":\n        chain.setHeading({ level: 1 }).run();\n        break;\n      case \"heading2\":\n        chain.setHeading({ level: 2 }).run();\n        break;\n      case \"heading3\":\n        chain.setHeading({ level: 3 }).run();\n        break;\n      case \"bulletList\":\n        chain.toggleBulletList().run();\n        break;\n      case \"orderedList\":\n        chain.toggleOrderedList().run();\n        break;\n      case \"blockquote\":\n        chain.toggleBlockquote().run();\n        break;\n      case \"codeBlock\":\n        chain.toggleCodeBlock().run();\n        break;\n      default:\n        break;\n    }\n  };\n\n  const inlineActions: MenuAction[] = [\n    {\n      label: \"Bold\",\n      icon: Bold,\n      isActive: () => editor.isActive(\"bold\"),\n      run: () => editor.chain().focus().toggleBold().run(),\n      toggle: true,\n    },\n    {\n      label: \"Italic\",\n      icon: Italic,\n      isActive: () => editor.isActive(\"italic\"),\n      run: () => editor.chain().focus().toggleItalic().run(),\n      toggle: true,\n    },\n    {\n      label: \"Underline\",\n      icon: UnderlineIcon,\n      isActive: () => editor.isActive(\"underline\"),\n      run: () => editor.chain().focus().toggleUnderline().run(),\n      toggle: true,\n    },\n    {\n      label: \"Strikethrough\",\n      icon: Strikethrough,\n      isActive: () => editor.isActive(\"strike\"),\n      run: () => editor.chain().focus().toggleStrike().run(),\n      toggle: true,\n    },\n    {\n      label: \"Code\",\n      icon: Code,\n      isActive: () => editor.isActive(\"code\"),\n      run: () => editor.chain().focus().toggleCode().run(),\n      toggle: true,\n    },\n    {\n      label: \"Remove formatting\",\n      icon: RemoveFormatting,\n      run: () => editor.chain().focus().unsetAllMarks().clearNodes().run(),\n    },\n  ];\n\n  const openLinkInput = () => {\n    if (showLinkInput) {\n      setShowLinkInput(false);\n      return;\n    }\n    setLinkUrl(editor.isActive(\"link\") ? (editor.getAttributes(\"link\").href as string) || \"\" : \"\");\n    setShowLinkInput(true);\n    setShowTableActions(false);\n    setShowAltInput(false);\n  };\n\n  const toggleTableActions = () => {\n    if (!isInTable) return;\n    setShowTableActions((current) => !current);\n    setShowLinkInput(false);\n    setShowAltInput(false);\n  };\n\n  const toggleAltInput = () => {\n    if (!isOnImage) return;\n    if (showAltInput) {\n      setShowAltInput(false);\n      return;\n    }\n    const alt = editor.getAttributes(\"image\").alt;\n    setImageAltText(typeof alt === \"string\" ? alt : \"\");\n    setShowAltInput(true);\n    setShowLinkInput(false);\n    setShowTableActions(false);\n  };\n\n  const applyLink = () => {\n    const trimmed = linkUrl.trim();\n    if (!trimmed) return;\n    editor.chain().focus().extendMarkRange(\"link\").setLink({ href: trimmed }).run();\n    setShowLinkInput(false);\n  };\n\n  const removeLink = () => {\n    editor.chain().focus().extendMarkRange(\"link\").unsetLink().run();\n    setShowLinkInput(false);\n    setLinkUrl(\"\");\n  };\n\n  const confirmOrRemoveLink = () => {\n    const trimmed = linkUrl.trim();\n    if (trimmed || editor.isActive(\"link\")) {\n      removeLink();\n      return;\n    }\n\n    setShowLinkInput(false);\n  };\n\n  const applyImageAlt = () => {\n    if (!isOnImage) return;\n    const trimmed = imageAltText.trim();\n    editor\n      .chain()\n      .focus()\n      .updateAttributes(\"image\", {\n        alt: trimmed || null,\n      })\n      .run();\n    setShowAltInput(false);\n  };\n\n  const clearImageAlt = () => {\n    if (!isOnImage) return;\n    editor.chain().focus().updateAttributes(\"image\", { alt: null }).run();\n    setImageAltText(\"\");\n    setShowAltInput(false);\n  };\n\n  const addRow = () => editor.chain().focus().addRowAfter().run();\n  const removeRow = () => editor.chain().focus().deleteRow().run();\n  const addColumn = () => editor.chain().focus().addColumnAfter().run();\n  const removeColumn = () => editor.chain().focus().deleteColumn().run();\n  const onSourceChange = (nextValue: string) => {\n    setSourceValue(nextValue);\n\n    if (sourceDebounceRef.current) clearTimeout(sourceDebounceRef.current);\n    sourceDebounceRef.current = setTimeout(() => {\n      editor.commands.setContent(nextValue, { contentType: format });\n      sourceDebounceRef.current = null;\n    }, sourceDebounceMs);\n  };\n\n  const toolbarButtonClass =\n    \"inline-flex size-7 items-center justify-center rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50\";\n  const toolbarToggleButtonClass = `${toolbarButtonClass} aria-pressed:bg-accent aria-pressed:text-accent-foreground`;\n  const toolbarInputClass =\n    \"border-input bg-background text-foreground h-7 rounded-md border px-2 text-sm shadow-xs outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\";\n  const sourceTextareaClass =\n    \"border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 min-h-16 w-full rounded-md border bg-transparent px-3 py-2 font-mono text-base shadow-xs transition-[color,box-shadow] outline-none [field-sizing:content] focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\";\n\n  const renderIconButton = ({\n    label,\n    icon: Icon,\n    onClick,\n    disabled,\n    toggle = false,\n    pressed = false,\n    className,\n  }: IconButtonOptions) => (\n    <button\n      key={label}\n      type=\"button\"\n      onClick={onClick}\n      disabled={disabled}\n      aria-label={label}\n      aria-pressed={toggle ? pressed : undefined}\n      className={`${toggle ? toolbarToggleButtonClass : toolbarButtonClass}${className ? ` ${className}` : \"\"}`}\n      title={label}\n    >\n      <Icon className=\"size-4\" />\n    </button>\n  );\n  return (\n    <div {...props}>\n      <div>\n        {isSourceMode ? (\n          <div>\n            <textarea\n              id=\"source-editor\"\n              value={sourceValue}\n              onChange={(event) => onSourceChange(event.target.value)}\n              rows={1}\n              disabled={disabled}\n              className={sourceTextareaClass}\n            />\n          </div>\n        ) : null}\n      </div>\n      <BubbleMenu\n        pluginKey=\"editor-bubble\"\n        ref={bubbleMenuRef}\n        editor={editor}\n        className=\"z-50 w-fit max-w-[95vw] text-popover-foreground outline-hidden\"\n        options={{\n          placement: \"top\",\n          offset: 10,\n          flip: { padding: 8 },\n          shift: { padding: 8 },\n        }}\n        shouldShow={({ editor: bubbleEditor, from, to, view, element }) => {\n          const hasEditorFocus = view.hasFocus() || element.contains(document.activeElement);\n          if (!hasEditorFocus) return false;\n          return (\n            !isSourceMode &&\n            (showLinkInput || showTableActions || showAltInput || (!bubbleEditor.state.selection.empty && from !== to))\n          );\n        }}\n      >\n        <div className=\"flex flex-col gap-1\">\n          <div className=\"border-border bg-popover flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm whitespace-nowrap\">\n            <div className=\"group/native-select relative w-fit\">\n              <select\n                id=\"block-style\"\n                value={getBlockType()}\n                onChange={(event) => setBlockType(event.target.value as BlockType)}\n                disabled={disabled}\n                aria-label=\"Block style\"\n                className=\"h-7 w-full appearance-none rounded-md border border-transparent bg-transparent px-2 pr-5.5 text-sm shadow-none outline-none hover:bg-accent focus-visible:outline-none focus-visible:ring-0 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                {blockOptions.map((option) => (\n                  <option key={option.value} value={option.value}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n              <ChevronDownIcon\n                className=\"text-muted-foreground pointer-events-none absolute top-1/2 right-1.5 size-3.5 -translate-y-1/2 opacity-50\"\n                aria-hidden=\"true\"\n              />\n            </div>\n            {inlineActions.map((action) =>\n              renderIconButton({\n                label: action.label,\n                icon: action.icon,\n                onClick: action.run,\n                disabled,\n                toggle: Boolean(action.toggle),\n                pressed: action.toggle ? action.isActive() : false,\n              }),\n            )}\n            {renderIconButton({\n              label: \"Link\",\n              icon: LinkIcon,\n              onClick: openLinkInput,\n              disabled,\n              toggle: true,\n              pressed: showLinkInput || editor.isActive(\"link\"),\n            })}\n            {isOnImage ? (\n              <button\n                type=\"button\"\n                aria-label=\"Image alt text\"\n                title=\"Image alt text\"\n                aria-pressed={showAltInput}\n                onClick={toggleAltInput}\n                disabled={disabled}\n                className={`${toolbarToggleButtonClass} w-auto px-2 text-xs font-medium`}\n              >\n                ALT\n              </button>\n            ) : null}\n            {isInTable\n              ? renderIconButton({\n                  label: \"Table\",\n                  icon: TableIcon,\n                  onClick: toggleTableActions,\n                  disabled,\n                  toggle: true,\n                  pressed: showTableActions,\n                })\n              : null}\n          </div>\n          {showLinkInput ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <input\n                id=\"link-url\"\n                type=\"url\"\n                placeholder=\"https://example.com\"\n                value={linkUrl}\n                onChange={(event) => setLinkUrl(event.target.value)}\n                disabled={disabled}\n                className={`${toolbarInputClass} min-w-56 flex-1`}\n              />\n              {renderIconButton({\n                label: \"Set link\",\n                icon: Check,\n                onClick: applyLink,\n                disabled: disabled || !linkUrl.trim(),\n              })}\n              {renderIconButton({\n                label: \"Remove link\",\n                icon: X,\n                onClick: confirmOrRemoveLink,\n                disabled,\n                className: \"ml-auto\",\n              })}\n            </div>\n          ) : null}\n          {showAltInput && isOnImage ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <input\n                id=\"image-alt\"\n                type=\"text\"\n                placeholder=\"Describe image\"\n                value={imageAltText}\n                onChange={(event) => setImageAltText(event.target.value)}\n                disabled={disabled}\n                className={`${toolbarInputClass} min-w-56 flex-1`}\n              />\n              {renderIconButton({\n                label: \"Save alt text\",\n                icon: Check,\n                onClick: applyImageAlt,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove alt text\",\n                icon: X,\n                onClick: clearImageAlt,\n                disabled,\n                className: \"ml-auto\",\n              })}\n            </div>\n          ) : null}\n          {showTableActions && isInTable ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 inline-flex w-fit flex-nowrap items-center gap-1 overflow-x-auto self-end rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <span className=\"text-sm ml-1 text-muted-foreground\">Rows:</span>\n              {renderIconButton({\n                label: \"Add row\",\n                icon: Plus,\n                onClick: addRow,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove row\",\n                icon: Minus,\n                onClick: removeRow,\n                disabled,\n              })}\n              <span className=\"bg-border mx-0.5 h-4 w-px\" aria-hidden=\"true\" />\n              <span className=\"text-sm text-muted-foreground\">Columns:</span>\n              {renderIconButton({\n                label: \"Add column\",\n                icon: Plus,\n                onClick: addColumn,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove column\",\n                icon: Minus,\n                onClick: removeColumn,\n                disabled,\n              })}\n            </div>\n          ) : null}\n        </div>\n      </BubbleMenu>\n      {!isSourceMode ? <EditorContent editor={editor} className=\"cn-editor\" /> : null}\n    </div>\n  );\n}\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/editor/slash-command/commands.ts",
      "content": "import { Extension } from \"@tiptap/core\";\nimport Suggestion from \"@tiptap/suggestion\";\nimport suggestion from \"./suggestion\";\n\nconst SlashCommands = Extension.create({\n  name: \"slash-commands\",\n\n  addProseMirrorPlugins() {\n    return [\n      Suggestion({\n        editor: this.editor,\n        char: \"/\",\n        command: ({ editor, range, props }) => {\n          props.command({ editor, range });\n        },\n        ...suggestion,\n      }),\n    ];\n  },\n});\n\nexport default SlashCommands;\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/editor/slash-command/commands-list.tsx",
      "content": "import { forwardRef, useEffect, useImperativeHandle, useState } from \"react\";\nimport type { Editor } from \"@tiptap/core\";\nimport type { LucideIcon } from \"lucide-react\";\nimport { Ban } from \"lucide-react\";\n\nexport type SlashItem = {\n  title: string;\n  icon: LucideIcon;\n  command: (params: { editor: Editor; range: { from: number; to: number } }) => void;\n};\n\ntype CommandsListProps = {\n  items: SlashItem[];\n  command: (item: SlashItem) => void;\n};\n\nexport type CommandsListHandle = {\n  onKeyDown: (event: KeyboardEvent) => boolean;\n};\n\nconst CommandsList = forwardRef<CommandsListHandle, CommandsListProps>(({ items, command }, ref) => {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n\n  useEffect(() => {\n    setSelectedIndex(0);\n  }, [items]);\n\n  const selectItem = (index: number) => {\n    const item = items[index];\n    if (item) command(item);\n  };\n\n  useImperativeHandle(ref, () => ({\n    onKeyDown: (event: KeyboardEvent) => {\n      if (!items.length) return false;\n\n      if (event.key === \"ArrowUp\") {\n        event.preventDefault();\n        setSelectedIndex((current) => (current + items.length - 1) % items.length);\n        return true;\n      }\n\n      if (event.key === \"ArrowDown\") {\n        event.preventDefault();\n        setSelectedIndex((current) => (current + 1) % items.length);\n        return true;\n      }\n\n      if (event.key === \"Enter\") {\n        event.preventDefault();\n        selectItem(selectedIndex);\n        return true;\n      }\n\n      return false;\n    },\n  }));\n\n  return (\n    <div className=\"bg-popover text-popover-foreground border-border z-50 min-w-44 overflow-hidden rounded-md border p-1 shadow-md\">\n      {items.length ? (\n        items.map((item, index) => (\n          <button\n            key={item.title}\n            type=\"button\"\n            onClick={() => selectItem(index)}\n            aria-selected={selectedIndex === index}\n            className=\"focus:bg-accent focus:text-accent-foreground aria-selected:bg-accent aria-selected:text-accent-foreground relative flex w-full cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none\"\n          >\n            <item.icon className=\"mr-2 size-4\" />\n            {item.title}\n          </button>\n        ))\n      ) : (\n        <div className=\"text-muted-foreground flex items-center px-2 py-1.5 text-sm\">\n          <Ban className=\"mr-2 size-4\" />\n          No results\n        </div>\n      )}\n    </div>\n  );\n});\n\nCommandsList.displayName = \"CommandsList\";\n\nexport default CommandsList;\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/editor/slash-command/suggestion.tsx",
      "content": "import { ReactRenderer } from \"@tiptap/react\";\nimport type { Editor } from \"@tiptap/core\";\nimport tippy, { type Instance as TippyInstance } from \"tippy.js\";\nimport CommandsList, { type CommandsListHandle, type SlashItem } from \"./commands-list\";\nimport { Code, Heading1, Heading2, Heading3, Image, List, ListOrdered, Pilcrow, Quote, Table } from \"lucide-react\";\n\ntype SuggestionProps = {\n  editor: Editor;\n  range: { from: number; to: number };\n  query: string;\n  clientRect?: (() => DOMRect | null) | null;\n};\n\nconst allItems: SlashItem[] = [\n  {\n    title: \"Text\",\n    icon: Pilcrow,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setParagraph().run(),\n  },\n  {\n    title: \"Heading 1\",\n    icon: Heading1,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 1 }).run(),\n  },\n  {\n    title: \"Heading 2\",\n    icon: Heading2,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 2 }).run(),\n  },\n  {\n    title: \"Heading 3\",\n    icon: Heading3,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 3 }).run(),\n  },\n  {\n    title: \"Bulleted list\",\n    icon: List,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleBulletList().run(),\n  },\n  {\n    title: \"Numbered list\",\n    icon: ListOrdered,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleOrderedList().run(),\n  },\n  {\n    title: \"Image\",\n    icon: Image,\n    command: ({ editor, range }) => {\n      const src = window.prompt(\"Image URL\");\n      if (!src) return;\n      editor.chain().focus().deleteRange(range).setImage({ src }).run();\n    },\n  },\n  {\n    title: \"Table\",\n    icon: Table,\n    command: ({ editor, range }) =>\n      editor.chain().focus().deleteRange(range).insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run(),\n  },\n  {\n    title: \"Quote\",\n    icon: Quote,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleBlockquote().run(),\n  },\n  {\n    title: \"Code block\",\n    icon: Code,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleCodeBlock().run(),\n  },\n];\n\nexport default {\n  items: ({ query }: { query: string }) =>\n    allItems.filter((item) => item.title.toLowerCase().includes(query.toLowerCase())).slice(0, 10),\n\n  render: () => {\n    let component: ReactRenderer<CommandsListHandle> | null = null;\n    let popup: TippyInstance | null = null;\n\n    return {\n      onStart: (props: SuggestionProps) => {\n        component = new ReactRenderer(CommandsList, {\n          props,\n          editor: props.editor,\n        });\n\n        if (!props.clientRect) return;\n        const referenceRect = () => props.clientRect?.() ?? new DOMRect(0, 0, 0, 0);\n\n        popup = tippy(document.body, {\n          getReferenceClientRect: referenceRect,\n          appendTo: () => document.body,\n          content: component.element,\n          showOnCreate: true,\n          interactive: true,\n          trigger: \"manual\",\n          placement: \"bottom-start\",\n        });\n      },\n\n      onUpdate: (props: SuggestionProps) => {\n        component?.updateProps(props);\n        if (!props.clientRect || !popup) return;\n        const referenceRect = () => props.clientRect?.() ?? new DOMRect(0, 0, 0, 0);\n        popup.setProps({ getReferenceClientRect: referenceRect });\n      },\n\n      onKeyDown: ({ event }: { event: KeyboardEvent }) => {\n        if (event.key === \"Escape\" && popup) {\n          popup.hide();\n          return true;\n        }\n\n        return component?.ref?.onKeyDown(event) ?? false;\n      },\n\n      onExit: () => {\n        if (popup) popup.destroy();\n        component?.destroy();\n      },\n    };\n  },\n};\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}