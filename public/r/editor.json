{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "editor",
  "title": "Editor",
  "description": "A format-aware HTML/Markdown editor built on TipTap.",
  "dependencies": [
    "lucide-react",
    "@tiptap/core",
    "@tiptap/extension-image",
    "@tiptap/extension-link",
    "@tiptap/extension-table",
    "@tiptap/extension-table-cell",
    "@tiptap/extension-table-header",
    "@tiptap/extension-table-row",
    "@tiptap/extension-underline",
    "@tiptap/markdown",
    "@tiptap/react",
    "@tiptap/starter-kit",
    "@tiptap/suggestion",
    "tippy.js"
  ],
  "files": [
    {
      "path": "registry/default/editor/editor.tsx",
      "content": "import { type HTMLAttributes, useEffect, useRef, useState } from \"react\";\nimport { EditorContent, useEditor, useEditorState } from \"@tiptap/react\";\nimport { BubbleMenu } from \"@tiptap/react/menus\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Underline from \"@tiptap/extension-underline\";\nimport Link from \"@tiptap/extension-link\";\nimport Image from \"@tiptap/extension-image\";\nimport { Table } from \"@tiptap/extension-table\";\nimport TableRow from \"@tiptap/extension-table-row\";\nimport TableHeader from \"@tiptap/extension-table-header\";\nimport TableCell from \"@tiptap/extension-table-cell\";\nimport { Markdown } from \"@tiptap/markdown\";\nimport {\n  Bold,\n  Columns3,\n  Check,\n  ChevronDownIcon,\n  Code,\n  Minus,\n  Plus,\n  RemoveFormatting,\n  Rows3,\n  Table as TableIcon,\n  Italic,\n  Link as LinkIcon,\n  Strikethrough,\n  Underline as UnderlineIcon,\n  X,\n  type LucideIcon,\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport SlashCommands from \"./slash-command/commands\";\n\nexport type EditorFormat = \"html\" | \"markdown\";\n\ntype EditorProps = {\n  value?: string;\n  onChange?: (value: string) => void;\n  disabled?: boolean;\n  format?: EditorFormat;\n  className?: string;\n  editorClassName?: string;\n} & Omit<HTMLAttributes<HTMLDivElement>, \"onChange\" | \"className\">;\n\ntype ToggleAction = {\n  label: string;\n  icon: LucideIcon;\n  isActive: () => boolean;\n  run: () => void;\n  toggle: true;\n};\n\ntype PlainAction = {\n  label: string;\n  icon: LucideIcon;\n  run: () => void;\n  toggle?: false;\n};\n\ntype MenuAction = ToggleAction | PlainAction;\n\ntype IconButtonOptions = {\n  label: string;\n  icon: LucideIcon;\n  onClick: () => void;\n  disabled: boolean;\n  toggle?: boolean;\n  pressed?: boolean;\n  className?: string;\n};\n\ntype BlockType =\n  | \"paragraph\"\n  | \"heading1\"\n  | \"heading2\"\n  | \"heading3\"\n  | \"bulletList\"\n  | \"orderedList\"\n  | \"blockquote\"\n  | \"codeBlock\";\n\nconst blockOptions: Array<{ value: BlockType; label: string }> = [\n  { value: \"paragraph\", label: \"Text\" },\n  { value: \"heading1\", label: \"Heading 1\" },\n  { value: \"heading2\", label: \"Heading 2\" },\n  { value: \"heading3\", label: \"Heading 3\" },\n  { value: \"bulletList\", label: \"Bulleted list\" },\n  { value: \"orderedList\", label: \"Numbered list\" },\n  { value: \"blockquote\", label: \"Quote\" },\n  { value: \"codeBlock\", label: \"Code block\" },\n];\n\nexport function Editor({\n  value = \"\",\n  onChange = () => undefined,\n  disabled = false,\n  format = \"html\",\n  className,\n  editorClassName,\n  ...props\n}: EditorProps) {\n  const [showLinkInput, setShowLinkInput] = useState(false);\n  const [showTableActions, setShowTableActions] = useState(false);\n  const [showAltInput, setShowAltInput] = useState(false);\n  const [isInTable, setIsInTable] = useState(false);\n  const [isOnImage, setIsOnImage] = useState(false);\n  const [linkUrl, setLinkUrl] = useState(\"\");\n  const [imageAltText, setImageAltText] = useState(\"\");\n  const bubbleMenuRef = useRef<HTMLDivElement>(null);\n  const linkInputRef = useRef<HTMLInputElement>(null);\n  const tiptapSurfaceClass = cn(\n    \"border-input placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] md:text-sm\",\n    editorClassName,\n  );\n\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        link: false,\n        underline: false,\n      }),\n      Underline,\n      Link.configure({\n        openOnClick: false,\n        enableClickSelection: true,\n        HTMLAttributes: {\n          rel: null,\n          target: null,\n        },\n      }),\n      Image,\n      Table,\n      TableRow,\n      TableHeader,\n      TableCell,\n      Markdown,\n      SlashCommands,\n    ],\n    content: value || (format === \"markdown\" ? \"\" : \"<p></p>\"),\n    editorProps: {\n      attributes: {\n        class: tiptapSurfaceClass,\n      },\n    },\n    editable: !disabled,\n    immediatelyRender: false,\n    onUpdate: ({ editor: nextEditor }) => {\n      onChange(format === \"markdown\" ? nextEditor.getMarkdown() : nextEditor.getHTML());\n    },\n  });\n\n  const activeState = useEditorState({\n    editor,\n    selector: ({ editor: currentEditor }) => {\n      if (!currentEditor) {\n        return {\n          blockType: \"paragraph\" as BlockType,\n          bold: false,\n          italic: false,\n          underline: false,\n          strike: false,\n          code: false,\n          link: false,\n        };\n      }\n\n      const blockType: BlockType = currentEditor.isActive(\"heading\", { level: 1 })\n        ? \"heading1\"\n        : currentEditor.isActive(\"heading\", { level: 2 })\n          ? \"heading2\"\n          : currentEditor.isActive(\"heading\", { level: 3 })\n            ? \"heading3\"\n            : currentEditor.isActive(\"bulletList\")\n              ? \"bulletList\"\n              : currentEditor.isActive(\"orderedList\")\n                ? \"orderedList\"\n                : currentEditor.isActive(\"blockquote\")\n                  ? \"blockquote\"\n                  : currentEditor.isActive(\"codeBlock\")\n                    ? \"codeBlock\"\n                    : \"paragraph\";\n\n      return {\n        blockType,\n        bold: currentEditor.isActive(\"bold\"),\n        italic: currentEditor.isActive(\"italic\"),\n        underline: currentEditor.isActive(\"underline\"),\n        strike: currentEditor.isActive(\"strike\"),\n        code: currentEditor.isActive(\"code\"),\n        link: currentEditor.isActive(\"link\"),\n      };\n    },\n  });\n\n  useEffect(() => {\n    if (!editor) return;\n    const current = format === \"markdown\" ? editor.getMarkdown() : editor.getHTML();\n    if (value !== current) {\n      editor.commands.setContent(value || (format === \"markdown\" ? \"\" : \"<p></p>\"), {\n        emitUpdate: false,\n        contentType: format,\n      });\n    }\n  }, [editor, value, format]);\n\n  useEffect(() => {\n    if (!editor) return;\n    editor.setEditable(!disabled);\n  }, [editor, disabled]);\n\n  useEffect(() => {\n    if (!editor) return;\n    editor.setOptions({\n      editorProps: {\n        attributes: {\n          class: tiptapSurfaceClass,\n        },\n      },\n    });\n  }, [editor, tiptapSurfaceClass]);\n\n  useEffect(() => {\n    if ((!showLinkInput && !showTableActions && !showAltInput) || !editor) return;\n\n    const onPointerDown = (event: PointerEvent) => {\n      const target = event.target as Node | null;\n      if (!target) return;\n\n      const insideBubble = bubbleMenuRef.current?.contains(target) ?? false;\n      if (!insideBubble) {\n        setShowLinkInput(false);\n        setShowTableActions(false);\n        setShowAltInput(false);\n      }\n    };\n\n    document.addEventListener(\"pointerdown\", onPointerDown, true);\n    return () => {\n      document.removeEventListener(\"pointerdown\", onPointerDown, true);\n    };\n  }, [showLinkInput, showTableActions, showAltInput, editor]);\n\n  useEffect(() => {\n    if (!showLinkInput) return;\n    const frameId = requestAnimationFrame(() => {\n      linkInputRef.current?.focus();\n      linkInputRef.current?.select();\n    });\n    return () => cancelAnimationFrame(frameId);\n  }, [showLinkInput]);\n\n  useEffect(() => {\n    if (!editor) return;\n\n    const updateTableContext = () => {\n      const nextIsInTable =\n        editor.isActive(\"table\") ||\n        editor.isActive(\"tableRow\") ||\n        editor.isActive(\"tableHeader\") ||\n        editor.isActive(\"tableCell\");\n      const nextIsOnImage = editor.isActive(\"image\");\n\n      setIsInTable(nextIsInTable);\n      if (!nextIsInTable) setShowTableActions(false);\n      setIsOnImage(nextIsOnImage);\n      if (!nextIsOnImage) setShowAltInput(false);\n    };\n\n    updateTableContext();\n    editor.on(\"selectionUpdate\", updateTableContext);\n    editor.on(\"transaction\", updateTableContext);\n\n    return () => {\n      editor.off(\"selectionUpdate\", updateTableContext);\n      editor.off(\"transaction\", updateTableContext);\n    };\n  }, [editor]);\n\n  if (!editor) return null;\n\n  const setBlockType = (next: BlockType) => {\n    const chain = editor.chain().focus();\n\n    switch (next) {\n      case \"paragraph\":\n        chain.setParagraph().run();\n        break;\n      case \"heading1\":\n        chain.setHeading({ level: 1 }).run();\n        break;\n      case \"heading2\":\n        chain.setHeading({ level: 2 }).run();\n        break;\n      case \"heading3\":\n        chain.setHeading({ level: 3 }).run();\n        break;\n      case \"bulletList\":\n        chain.toggleBulletList().run();\n        break;\n      case \"orderedList\":\n        chain.toggleOrderedList().run();\n        break;\n      case \"blockquote\":\n        chain.toggleBlockquote().run();\n        break;\n      case \"codeBlock\":\n        chain.toggleCodeBlock().run();\n        break;\n      default:\n        break;\n    }\n  };\n\n  const inlineActions: MenuAction[] = [\n    {\n      label: \"Bold\",\n      icon: Bold,\n      isActive: () => activeState.bold,\n      run: () => editor.chain().focus().toggleBold().run(),\n      toggle: true,\n    },\n    {\n      label: \"Italic\",\n      icon: Italic,\n      isActive: () => activeState.italic,\n      run: () => editor.chain().focus().toggleItalic().run(),\n      toggle: true,\n    },\n    {\n      label: \"Underline\",\n      icon: UnderlineIcon,\n      isActive: () => activeState.underline,\n      run: () => editor.chain().focus().toggleUnderline().run(),\n      toggle: true,\n    },\n    {\n      label: \"Strikethrough\",\n      icon: Strikethrough,\n      isActive: () => activeState.strike,\n      run: () => editor.chain().focus().toggleStrike().run(),\n      toggle: true,\n    },\n    {\n      label: \"Code\",\n      icon: Code,\n      isActive: () => activeState.code,\n      run: () => editor.chain().focus().toggleCode().run(),\n      toggle: true,\n    },\n    {\n      label: \"Remove formatting\",\n      icon: RemoveFormatting,\n      run: () => editor.chain().focus().unsetAllMarks().clearNodes().run(),\n    },\n  ];\n\n  const openLinkInput = () => {\n    if (showLinkInput) {\n      setShowLinkInput(false);\n      return;\n    }\n    setLinkUrl(editor.isActive(\"link\") ? (editor.getAttributes(\"link\").href as string) || \"\" : \"\");\n    setShowLinkInput(true);\n    setShowTableActions(false);\n    setShowAltInput(false);\n  };\n\n  const toggleTableActions = () => {\n    if (!isInTable) return;\n    setShowTableActions((current) => !current);\n    setShowLinkInput(false);\n    setShowAltInput(false);\n  };\n\n  const toggleAltInput = () => {\n    if (!isOnImage) return;\n    if (showAltInput) {\n      setShowAltInput(false);\n      return;\n    }\n    const alt = editor.getAttributes(\"image\").alt;\n    setImageAltText(typeof alt === \"string\" ? alt : \"\");\n    setShowAltInput(true);\n    setShowLinkInput(false);\n    setShowTableActions(false);\n  };\n\n  const applyLink = () => {\n    const trimmed = linkUrl.trim();\n    if (!trimmed) return;\n    editor.chain().focus().extendMarkRange(\"link\").setLink({ href: trimmed }).run();\n    setShowLinkInput(false);\n  };\n\n  const removeLink = () => {\n    editor.chain().focus().extendMarkRange(\"link\").unsetLink().run();\n    setShowLinkInput(false);\n    setLinkUrl(\"\");\n  };\n\n  const confirmOrRemoveLink = () => {\n    const trimmed = linkUrl.trim();\n    if (trimmed || editor.isActive(\"link\")) {\n      removeLink();\n      return;\n    }\n\n    setShowLinkInput(false);\n  };\n\n  const applyImageAlt = () => {\n    if (!isOnImage) return;\n    const trimmed = imageAltText.trim();\n    editor\n      .chain()\n      .focus()\n      .updateAttributes(\"image\", {\n        alt: trimmed || null,\n      })\n      .run();\n    setShowAltInput(false);\n  };\n\n  const clearImageAlt = () => {\n    if (!isOnImage) return;\n    editor.chain().focus().updateAttributes(\"image\", { alt: null }).run();\n    setImageAltText(\"\");\n    setShowAltInput(false);\n  };\n\n  const addRow = () => editor.chain().focus().addRowAfter().run();\n  const removeRow = () => editor.chain().focus().deleteRow().run();\n  const addColumn = () => editor.chain().focus().addColumnAfter().run();\n  const removeColumn = () => editor.chain().focus().deleteColumn().run();\n\n  const toolbarButtonClass =\n    \"inline-flex size-7 items-center justify-center rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50\";\n  const toolbarToggleButtonClass = `${toolbarButtonClass} aria-pressed:bg-accent aria-pressed:text-accent-foreground`;\n  const toolbarInputClass =\n    \"border-input bg-background text-foreground h-7 rounded-md border px-2 text-sm shadow-xs outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\";\n\n  const renderIconButton = ({\n    label,\n    icon: Icon,\n    onClick,\n    disabled,\n    toggle = false,\n    pressed = false,\n    className,\n  }: IconButtonOptions) => (\n    <button\n      key={label}\n      type=\"button\"\n      onClick={onClick}\n      disabled={disabled}\n      aria-label={label}\n      aria-pressed={toggle ? pressed : undefined}\n      className={`${toggle ? toolbarToggleButtonClass : toolbarButtonClass}${className ? ` ${className}` : \"\"}`}\n      title={label}\n    >\n      <Icon className=\"size-4\" />\n    </button>\n  );\n  return (\n    <div {...props} className={cn(\"cn-editor\", className)}>\n      <BubbleMenu\n        pluginKey=\"editor-bubble\"\n        ref={bubbleMenuRef}\n        editor={editor}\n        className=\"z-50 w-fit max-w-[95vw] text-popover-foreground outline-hidden\"\n        options={{\n          placement: \"top\",\n          offset: 10,\n          flip: { padding: 8 },\n          shift: { padding: 8 },\n        }}\n        shouldShow={({ editor: bubbleEditor, from, to, view, element }) => {\n          const hasEditorFocus = view.hasFocus() || element.contains(document.activeElement);\n          if (!hasEditorFocus) return false;\n          return showLinkInput || showTableActions || showAltInput || (!bubbleEditor.state.selection.empty && from !== to);\n        }}\n      >\n        <div className=\"flex flex-col gap-1\">\n          <div className=\"border-border bg-popover flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm whitespace-nowrap\">\n            <div className=\"group/native-select relative w-fit\">\n              <select\n                id=\"block-style\"\n                value={activeState.blockType}\n                onChange={(event) => setBlockType(event.target.value as BlockType)}\n                disabled={disabled}\n                aria-label=\"Block style\"\n                className=\"h-7 w-full appearance-none rounded-md border border-transparent bg-transparent px-2 pr-5.5 text-sm shadow-none outline-none hover:bg-accent focus-visible:outline-none focus-visible:ring-0 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                {blockOptions.map((option) => (\n                  <option key={option.value} value={option.value}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n              <ChevronDownIcon\n                className=\"text-muted-foreground pointer-events-none absolute top-1/2 right-1.5 size-3.5 -translate-y-1/2 opacity-50\"\n                aria-hidden=\"true\"\n              />\n            </div>\n            {inlineActions.map((action) =>\n              renderIconButton({\n                label: action.label,\n                icon: action.icon,\n                onClick: action.run,\n                disabled,\n                toggle: Boolean(action.toggle),\n                pressed: action.toggle ? action.isActive() : false,\n              }),\n            )}\n            {renderIconButton({\n              label: \"Link\",\n              icon: LinkIcon,\n              onClick: openLinkInput,\n              disabled,\n              toggle: true,\n              pressed: showLinkInput || activeState.link,\n            })}\n            {isOnImage ? (\n              <button\n                type=\"button\"\n                aria-label=\"Image alt text\"\n                title=\"Image alt text\"\n                aria-pressed={showAltInput}\n                onClick={toggleAltInput}\n                disabled={disabled}\n                className={`${toolbarToggleButtonClass} size-7 text-xs`}\n              >\n                ALT\n              </button>\n            ) : null}\n            {isInTable\n              ? renderIconButton({\n                  label: \"Table\",\n                  icon: TableIcon,\n                  onClick: toggleTableActions,\n                  disabled,\n                  toggle: true,\n                  pressed: showTableActions,\n                })\n              : null}\n          </div>\n          {showLinkInput ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <input\n                id=\"link-url\"\n                ref={linkInputRef}\n                type=\"url\"\n                placeholder=\"https://example.com\"\n                value={linkUrl}\n                onChange={(event) => setLinkUrl(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === \"Enter\") {\n                    event.preventDefault();\n                    applyLink();\n                  }\n                }}\n                disabled={disabled}\n                className={`${toolbarInputClass} min-w-56 flex-1`}\n              />\n              {renderIconButton({\n                label: \"Set link\",\n                icon: Check,\n                onClick: applyLink,\n                disabled: disabled || !linkUrl.trim(),\n              })}\n              {renderIconButton({\n                label: \"Remove link\",\n                icon: X,\n                onClick: confirmOrRemoveLink,\n                disabled,\n                className: \"ml-auto\",\n              })}\n            </div>\n          ) : null}\n          {showAltInput && isOnImage ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 flex flex-nowrap items-center gap-0.5 overflow-x-auto rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <input\n                id=\"image-alt\"\n                type=\"text\"\n                placeholder=\"Describe image\"\n                value={imageAltText}\n                onChange={(event) => setImageAltText(event.target.value)}\n                disabled={disabled}\n                className={`${toolbarInputClass} min-w-56 flex-1`}\n              />\n              {renderIconButton({\n                label: \"Save alt text\",\n                icon: Check,\n                onClick: applyImageAlt,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove alt text\",\n                icon: X,\n                onClick: clearImageAlt,\n                disabled,\n                className: \"ml-auto\",\n              })}\n            </div>\n          ) : null}\n          {showTableActions && isInTable ? (\n            <div\n              data-state=\"open\"\n              className=\"border-border bg-popover data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95 data-[state=open]:slide-in-from-top-1 inline-flex w-fit flex-nowrap items-center gap-1 overflow-x-auto self-end rounded-md border p-1 shadow-sm duration-200 whitespace-nowrap\"\n            >\n              <span className=\"text-sm ml-1 text-muted-foreground\">Rows:</span>\n              {renderIconButton({\n                label: \"Add row\",\n                icon: Plus,\n                onClick: addRow,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove row\",\n                icon: Minus,\n                onClick: removeRow,\n                disabled,\n              })}\n              <span className=\"bg-border mx-0.5 h-4 w-px\" aria-hidden=\"true\" />\n              <span className=\"text-sm text-muted-foreground\">Columns:</span>\n              {renderIconButton({\n                label: \"Add column\",\n                icon: Plus,\n                onClick: addColumn,\n                disabled,\n              })}\n              {renderIconButton({\n                label: \"Remove column\",\n                icon: Minus,\n                onClick: removeColumn,\n                disabled,\n              })}\n            </div>\n          ) : null}\n        </div>\n      </BubbleMenu>\n      <EditorContent editor={editor} />\n    </div>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/ui/editor/index.tsx"
    },
    {
      "path": "registry/default/editor/slash-command/commands.ts",
      "content": "import { Extension } from \"@tiptap/core\";\nimport Suggestion from \"@tiptap/suggestion\";\nimport suggestion from \"./suggestion\";\n\nconst SlashCommands = Extension.create({\n  name: \"slash-commands\",\n\n  addProseMirrorPlugins() {\n    return [\n      Suggestion({\n        editor: this.editor,\n        char: \"/\",\n        command: ({ editor, range, props }) => {\n          props.command({ editor, range });\n        },\n        ...suggestion,\n      }),\n    ];\n  },\n});\n\nexport default SlashCommands;\n",
      "type": "registry:component",
      "target": "components/ui/editor/slash-command/commands.ts"
    },
    {
      "path": "registry/default/editor/slash-command/commands-list.tsx",
      "content": "import { forwardRef, useEffect, useImperativeHandle, useState } from \"react\";\nimport type { Editor } from \"@tiptap/core\";\nimport type { LucideIcon } from \"lucide-react\";\nimport { Ban } from \"lucide-react\";\n\nexport type SlashItem = {\n  title: string;\n  icon: LucideIcon;\n  command: (params: { editor: Editor; range: { from: number; to: number } }) => void;\n};\n\ntype CommandsListProps = {\n  items: SlashItem[];\n  command: (item: SlashItem) => void;\n};\n\nexport type CommandsListHandle = {\n  onKeyDown: (event: KeyboardEvent) => boolean;\n};\n\nconst CommandsList = forwardRef<CommandsListHandle, CommandsListProps>(({ items, command }, ref) => {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n\n  useEffect(() => {\n    setSelectedIndex(0);\n  }, [items]);\n\n  const selectItem = (index: number) => {\n    const item = items[index];\n    if (item) command(item);\n  };\n\n  useImperativeHandle(ref, () => ({\n    onKeyDown: (event: KeyboardEvent) => {\n      if (!items.length) return false;\n\n      if (event.key === \"ArrowUp\") {\n        event.preventDefault();\n        setSelectedIndex((current) => (current + items.length - 1) % items.length);\n        return true;\n      }\n\n      if (event.key === \"ArrowDown\") {\n        event.preventDefault();\n        setSelectedIndex((current) => (current + 1) % items.length);\n        return true;\n      }\n\n      if (event.key === \"Enter\") {\n        event.preventDefault();\n        selectItem(selectedIndex);\n        return true;\n      }\n\n      return false;\n    },\n  }));\n\n  return (\n    <div className=\"bg-popover text-popover-foreground border-border z-50 min-w-44 overflow-hidden rounded-md border p-1 shadow-md\">\n      {items.length ? (\n        items.map((item, index) => (\n          <button\n            key={item.title}\n            type=\"button\"\n            onClick={() => selectItem(index)}\n            aria-selected={selectedIndex === index}\n            className=\"focus:bg-accent focus:text-accent-foreground aria-selected:bg-accent aria-selected:text-accent-foreground relative flex w-full cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none\"\n          >\n            <item.icon className=\"mr-2 size-4\" />\n            {item.title}\n          </button>\n        ))\n      ) : (\n        <div className=\"text-muted-foreground flex items-center px-2 py-1.5 text-sm\">\n          <Ban className=\"mr-2 size-4\" />\n          No results\n        </div>\n      )}\n    </div>\n  );\n});\n\nCommandsList.displayName = \"CommandsList\";\n\nexport default CommandsList;\n",
      "type": "registry:component",
      "target": "components/ui/editor/slash-command/commands-list.tsx"
    },
    {
      "path": "registry/default/editor/slash-command/suggestion.tsx",
      "content": "import { ReactRenderer } from \"@tiptap/react\";\nimport type { Editor } from \"@tiptap/core\";\nimport tippy, { type Instance as TippyInstance } from \"tippy.js\";\nimport CommandsList, { type CommandsListHandle, type SlashItem } from \"./commands-list\";\nimport { Code, Heading1, Heading2, Heading3, Image, List, ListOrdered, Pilcrow, Quote, Table } from \"lucide-react\";\n\ntype SuggestionProps = {\n  editor: Editor;\n  range: { from: number; to: number };\n  query: string;\n  clientRect?: (() => DOMRect | null) | null;\n};\n\nconst allItems: SlashItem[] = [\n  {\n    title: \"Text\",\n    icon: Pilcrow,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setParagraph().run(),\n  },\n  {\n    title: \"Heading 1\",\n    icon: Heading1,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 1 }).run(),\n  },\n  {\n    title: \"Heading 2\",\n    icon: Heading2,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 2 }).run(),\n  },\n  {\n    title: \"Heading 3\",\n    icon: Heading3,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).setHeading({ level: 3 }).run(),\n  },\n  {\n    title: \"Bulleted list\",\n    icon: List,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleBulletList().run(),\n  },\n  {\n    title: \"Numbered list\",\n    icon: ListOrdered,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleOrderedList().run(),\n  },\n  {\n    title: \"Image\",\n    icon: Image,\n    command: ({ editor, range }) => {\n      const src = window.prompt(\"Image URL\");\n      if (!src) return;\n      editor.chain().focus().deleteRange(range).setImage({ src }).run();\n    },\n  },\n  {\n    title: \"Table\",\n    icon: Table,\n    command: ({ editor, range }) =>\n      editor.chain().focus().deleteRange(range).insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run(),\n  },\n  {\n    title: \"Quote\",\n    icon: Quote,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleBlockquote().run(),\n  },\n  {\n    title: \"Code block\",\n    icon: Code,\n    command: ({ editor, range }) => editor.chain().focus().deleteRange(range).toggleCodeBlock().run(),\n  },\n];\n\nexport default {\n  items: ({ query }: { query: string }) =>\n    allItems.filter((item) => item.title.toLowerCase().includes(query.toLowerCase())).slice(0, 10),\n\n  render: () => {\n    let component: ReactRenderer<CommandsListHandle> | null = null;\n    let popup: TippyInstance | null = null;\n\n    return {\n      onStart: (props: SuggestionProps) => {\n        component = new ReactRenderer(CommandsList, {\n          props,\n          editor: props.editor,\n        });\n\n        if (!props.clientRect) return;\n        const referenceRect = () => props.clientRect?.() ?? new DOMRect(0, 0, 0, 0);\n\n        popup = tippy(document.body, {\n          getReferenceClientRect: referenceRect,\n          appendTo: () => document.body,\n          content: component.element,\n          showOnCreate: true,\n          interactive: true,\n          trigger: \"manual\",\n          placement: \"bottom-start\",\n        });\n      },\n\n      onUpdate: (props: SuggestionProps) => {\n        component?.updateProps(props);\n        if (!props.clientRect || !popup) return;\n        const referenceRect = () => props.clientRect?.() ?? new DOMRect(0, 0, 0, 0);\n        popup.setProps({ getReferenceClientRect: referenceRect });\n      },\n\n      onKeyDown: ({ event }: { event: KeyboardEvent }) => {\n        if (event.key === \"Escape\" && popup) {\n          popup.hide();\n          return true;\n        }\n\n        return component?.ref?.onKeyDown(event) ?? false;\n      },\n\n      onExit: () => {\n        if (popup) popup.destroy();\n        component?.destroy();\n      },\n    };\n  },\n};\n",
      "type": "registry:component",
      "target": "components/ui/editor/slash-command/suggestion.tsx"
    }
  ],
  "type": "registry:component"
}